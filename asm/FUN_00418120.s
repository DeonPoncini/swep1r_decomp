; FUN_00418120
SUB ESP,0x400
PUSH ESI
MOV ESI,dword ptr [ESP + 0x408]
TEST ESI,ESI
JZ 0x00418472
PUSH EDI
MOV ECX,0x100
XOR EAX,EAX
LEA EDI,[ESP + 0x8]
STOSD.REP ES:EDI
MOV EAX,dword ptr [ESI + 0x4d4]
PUSH EBX
TEST EAX,EAX
JZ 0x0041816a
PUSH 0x3ff
PUSH EAX
LEA EAX,[ESP + 0x14]
PUSH EAX
CALL 0x0049f340
ADD ESP,0xc
MOV byte ptr [ESP + 0x40b],0x0
MOV EBX,dword ptr [ESP + 0x414]
LEA EAX,[EBX + -0x8]
CMP EAX,0x26
JA 0x0041835a
XOR ECX,ECX
MOV CL,byte ptr [EAX + 0x4184a0]
JMP dword ptr [ECX*0x4 + 0x41847c]
PUSH 0x46
CALL 0x00440550
MOV DL,byte ptr [0x004d8bd0]
ADD ESP,0x4
OR DL,0x8
MOV byte ptr [0x004d8bd0],DL
MOV EDX,dword ptr [ESI + 0x1c]
PUSH EDX
PUSH 0x0
PUSH 0x49
PUSH ESI
CALL 0x004151a0
MOV EAX,dword ptr [ESI + 0x4d4]
MOV ECX,dword ptr [ESI + 0x1c]
MOV EDX,dword ptr [ESI + 0x8]
ADD ESP,0x10
PUSH EAX
PUSH ECX
PUSH 0xbb9
PUSH EDX
CALL 0x004151a0
MOV EAX,dword ptr [ESI + 0x52c]
ADD ESP,0x10
TEST EAX,0x10000
JZ 0x004181fb
MOV EAX,dword ptr [ESI + 0x4d4]
PUSH 0x0
PUSH EAX
CALL 0x004174e0
ADD ESP,0x8
MOV dword ptr [ESI + 0x4d4],EAX
JMP 0x004183ed
MOV EDI,dword ptr [ESI + 0x4d4]
TEST EDI,EDI
JZ 0x004183ed
TEST EAX,0x20000
JMP 0x004182e4
PUSH 0x47
CALL 0x00440550
MOV ECX,dword ptr [ESI + 0x4d8]
ADD ESP,0x4
PUSH ECX
PUSH 0x4d87d0
PUSH ESI
CALL 0x00414b80
MOV CL,byte ptr [0x004d8bd0]
ADD ESP,0xc
OR CL,0x8
MOV byte ptr [0x004d8bd0],CL
MOV EDX,dword ptr [ESI + 0x4d4]
MOV EAX,dword ptr [ESI + 0x1c]
MOV ECX,dword ptr [ESI + 0x8]
PUSH EDX
PUSH EAX
PUSH 0xbba
PUSH ECX
CALL 0x004151a0
ADD ESP,0x10
JMP 0x004183ed
MOV EAX,dword ptr [ESI + 0x530]
TEST EAX,EAX
JNZ 0x0041828a
MOV EDI,dword ptr [ESI + 0x4d4]
TEST EDI,EDI
JZ 0x004183ed
OR ECX,0xffffffff
XOR EAX,EAX
SCASB.REPNE ES:EDI
NOT ECX
DEC ECX
JZ 0x004183ed
PUSH 0x0
MOV dword ptr [ESI + 0x530],0x0
PUSH 0x0
JMP 0x004183e4
MOV EAX,dword ptr [ESI + 0x530]
TEST EAX,EAX
JZ 0x004183ed
MOV EDX,0x400
LEA ECX,[ESP + EAX*0x1 + 0xc]
SUB EDX,EAX
PUSH EDX
PUSH ECX
DEC ECX
PUSH ECX
CALL 0x0049f4e0
MOV EBX,dword ptr [ESI + 0x530]
ADD ESP,0xc
DEC EBX
MOV byte ptr [ESP + 0x40b],0x0
MOV dword ptr [ESI + 0x530],EBX
JMP 0x004183dd
MOV EDI,dword ptr [ESI + 0x4d4]
TEST EDI,EDI
JZ 0x004183ed
OR ECX,0xffffffff
XOR EAX,EAX
SCASB.REPNE ES:EDI
NOT ECX
DEC ECX
MOV dword ptr [ESI + 0x530],ECX
JMP 0x004183ed
MOV dword ptr [ESI + 0x530],0x0
JMP 0x004183ed
MOV EAX,dword ptr [ESI + 0x530]
TEST EAX,EAX
JBE 0x004183ed
DEC EAX
MOV dword ptr [ESI + 0x530],EAX
JMP 0x004183ed
MOV EDI,dword ptr [ESI + 0x4d4]
TEST EDI,EDI
JZ 0x004183ed
OR ECX,0xffffffff
XOR EAX,EAX
SCASB.REPNE ES:EDI
MOV EDX,dword ptr [ESI + 0x530]
NOT ECX
DEC ECX
CMP EDX,ECX
JNC 0x004183ed
INC EDX
MOV dword ptr [ESI + 0x530],EDX
JMP 0x004183ed
CMP dword ptr [0x004d1f9c],0x1
JLE 0x00418373
PUSH 0x107
PUSH EBX
CALL 0x0049f440
ADD ESP,0x8
JMP 0x00418382
MOV ECX,dword ptr [0x004d1d90]
MOV AX,word ptr [ECX + EBX*0x2]
AND EAX,0x107
TEST EAX,EAX
JNZ 0x0041838b
CMP EBX,0x20
JNZ 0x004183ed
MOV EAX,dword ptr [ESI + 0x534]
CMP EAX,0x400
MOV ECX,EAX
JC 0x0041839f
MOV ECX,0x400
MOV EAX,dword ptr [ESI + 0x530]
CMP EAX,ECX
JNC 0x004183ed
CMP EBX,0x20
JNZ 0x004183b2
TEST EAX,EAX
JZ 0x004183ed
MOV EDX,0x3ff
LEA ECX,[ESP + EAX*0x1 + 0xc]
SUB EDX,EAX
PUSH EDX
LEA EDX,[ESP + EAX*0x1 + 0x11]
PUSH ECX
PUSH EDX
CALL 0x0049f4e0
MOV EAX,dword ptr [ESI + 0x530]
ADD ESP,0xc
MOV byte ptr [ESP + EAX*0x1 + 0xc],BL
INC EAX
MOV dword ptr [ESI + 0x530],EAX
LEA EAX,[ESP + 0xc]
PUSH 0x0
PUSH EAX
PUSH ESI
CALL 0x00414b80
ADD ESP,0xc
MOV ECX,dword ptr [ESI + 0x530]
MOV EDX,dword ptr [ESI + 0x4dc]
MOV EAX,dword ptr [ESI + 0x4d4]
PUSH ECX
PUSH 0x0
PUSH EDX
PUSH EAX
CALL 0x00418680
MOV EDX,dword ptr [ESI + 0x24]
MOV ECX,dword ptr [ESI + 0x4dc]
MOV EDI,EAX
ADD ESP,0x10
ADD EDI,EDX
MOV EDX,dword ptr [ECX*0x4 + 0xe99720]
PUSH EDX
PUSH 0x4b51b8
CALL 0x0042de30
MOV EDX,dword ptr [ESI + 0x4dc]
MOV ECX,EAX
ADD ECX,EDI
ADD ESP,0x8
LEA EDI,[ECX + EAX*0x4]
MOV EAX,dword ptr [EDX*0x4 + 0xe99720]
PUSH EAX
PUSH 0x4b6668
CALL 0x0042df70
MOV ECX,dword ptr [ESI + 0x28]
MOV EDX,dword ptr [ESI + 0x30]
ADD ESP,0x8
SUB EDX,ECX
SHL EAX,0x1
INC EDX
PUSH EAX
SAR EDX,0x1
SAR EAX,0x1
SUB EDX,EAX
PUSH 0x1
ADD EDX,ECX
PUSH EDX
PUSH EDI
CALL 0x00411740
ADD ESP,0x10
POP EBX
POP EDI
POP ESI
ADD ESP,0x400
RET
