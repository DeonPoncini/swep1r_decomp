; FUN_004a5af0
MOV ECX,dword ptr [ESP + 0x4]
SUB ESP,0x1a8
MOV EAX,0x4d4558
PUSH EBX
PUSH EBP
PUSH ESI
PUSH EDI
XOR EBP,EBP
CMP ECX,dword ptr [EAX]
JZ 0x004a5b14
ADD EAX,0x8
INC EBP
CMP EAX,0x4d45e8
JC 0x004a5b05
CMP ECX,dword ptr [EBP*0x8 + 0x4d4558]
JNZ 0x004a5cbb
MOV EAX,[0x00dfaac8]
CMP EAX,0x1
JZ 0x004a5c7d
TEST EAX,EAX
JNZ 0x004a5b40
CMP dword ptr [0x004d1fb4],0x1
JZ 0x004a5c7d
CMP ECX,0xfc
JZ 0x004a5cbb
LEA EAX,[ESP + 0xb4]
PUSH 0x104
PUSH EAX
PUSH 0x0
CALL dword ptr [0x004ac100]
TEST EAX,EAX
JNZ 0x004a5b7b
MOV ECX,0x5
MOV ESI,0x4afdac
LEA EDI,[ESP + 0xb4]
MOVSD.REP ES:EDI,ESI
MOVSW ES:EDI,ESI
MOVSB ES:EDI,ESI
LEA EDI,[ESP + 0xb4]
OR ECX,0xffffffff
XOR EAX,EAX
LEA EBX,[ESP + 0xb4]
SCASB.REPNE ES:EDI
NOT ECX
CMP ECX,0x3c
JBE 0x004a5bc4
LEA EDI,[ESP + 0xb4]
OR ECX,0xffffffff
SCASB.REPNE ES:EDI
NOT ECX
DEC ECX
PUSH 0x3
MOV EBX,ECX
LEA ECX,[ESP + 0xb8]
SUB ECX,0x3b
PUSH 0x4afda8
ADD EBX,ECX
PUSH EBX
CALL 0x0049f340
ADD ESP,0xc
MOV ECX,0x6
MOV ESI,0x4afd8c
LEA EDI,[ESP + 0x14]
XOR EAX,EAX
MOVSD.REP ES:EDI,ESI
MOVSW ES:EDI,ESI
OR ECX,0xffffffff
MOV EDI,EBX
SCASB.REPNE ES:EDI
NOT ECX
SUB EDI,ECX
LEA EDX,[ESP + 0x14]
MOV EBX,ECX
MOV ESI,EDI
OR ECX,0xffffffff
MOV EDI,EDX
SCASB.REPNE ES:EDI
MOV ECX,EBX
DEC EDI
SHR ECX,0x2
MOVSD.REP ES:EDI,ESI
MOV ECX,EBX
LEA EDX,[ESP + 0x14]
AND ECX,0x3
PUSH 0x12010
MOVSB.REP ES:EDI,ESI
MOV EDI,0x4d1aa0
OR ECX,0xffffffff
SCASB.REPNE ES:EDI
NOT ECX
SUB EDI,ECX
PUSH 0x4afd64
MOV ESI,EDI
MOV EBX,ECX
MOV EDI,EDX
OR ECX,0xffffffff
SCASB.REPNE ES:EDI
MOV ECX,EBX
DEC EDI
SHR ECX,0x2
MOVSD.REP ES:EDI,ESI
MOV ECX,EBX
LEA EDX,[ESP + 0x1c]
AND ECX,0x3
MOVSB.REP ES:EDI,ESI
MOV EDI,dword ptr [EBP*0x8 + 0x4d455c]
OR ECX,0xffffffff
SCASB.REPNE ES:EDI
NOT ECX
SUB EDI,ECX
MOV ESI,EDI
MOV EBX,ECX
MOV EDI,EDX
OR ECX,0xffffffff
SCASB.REPNE ES:EDI
MOV ECX,EBX
DEC EDI
SHR ECX,0x2
MOVSD.REP ES:EDI,ESI
MOV ECX,EBX
LEA EAX,[ESP + 0x1c]
AND ECX,0x3
PUSH EAX
MOVSB.REP ES:EDI,ESI
CALL 0x004a8de0
ADD ESP,0xc
POP EDI
POP ESI
POP EBP
POP EBX
ADD ESP,0x1a8
RET
MOV EAX,[0x00ecd500]
TEST EAX,EAX
JZ 0x004a5c8e
MOV ESI,dword ptr [EAX + 0x48]
CMP ESI,-0x1
JNZ 0x004a5c98
PUSH -0xc
CALL dword ptr [0x004ac068]
MOV ESI,EAX
MOV EDX,dword ptr [EBP*0x8 + 0x4d455c]
LEA ECX,[ESP + 0x10]
PUSH 0x0
PUSH ECX
MOV EDI,EDX
OR ECX,0xffffffff
XOR EAX,EAX
SCASB.REPNE ES:EDI
NOT ECX
DEC ECX
PUSH ECX
PUSH EDX
PUSH ESI
CALL dword ptr [0x004ac110]
POP EDI
POP ESI
POP EBP
POP EBX
ADD ESP,0x1a8
RET
