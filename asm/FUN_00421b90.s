; FUN_00421b90
SUB ESP,0x104
PUSH ESI
PUSH EDI
PUSH 0x4b6d00
PUSH 0x4b4f6c
LEA EAX,[ESP + 0x14]
PUSH 0x4b2524
PUSH EAX
MOV dword ptr [ESP + 0x18],0x0
XOR ESI,ESI
CALL 0x0049eb80
ADD ESP,0x10
LEA ECX,[ESP + 0xc]
PUSH 0x4b5c4c
PUSH ECX
CALL 0x0049f1e0
MOV EDI,EAX
ADD ESP,0x8
TEST EDI,EDI
JZ 0x00421c1f
PUSH EDI
PUSH 0x4
LEA EDX,[ESP + 0x10]
PUSH 0x1
PUSH EDX
CALL 0x0049ffe0
ADD ESP,0x10
TEST EAX,EAX
JZ 0x00421c0f
CMP dword ptr [ESP + 0x8],0x10003
JNZ 0x00421c0f
PUSH EDI
PUSH 0xfd4
PUSH 0x1
PUSH 0xe364a0
CALL 0x0049ffe0
ADD ESP,0x10
TEST EAX,EAX
JNZ 0x00421c14
MOV ESI,0x1
PUSH EDI
CALL 0x0049f0f0
ADD ESP,0x4
JMP 0x00421c24
MOV ESI,0x1
TEST ESI,ESI
JNZ 0x00421c7d
PUSH 0xe364b4
PUSH 0x4b2304
PUSH 0x4eb3d0
CALL 0x0049eb80
MOV EDI,0x4eb3d0
OR ECX,0xffffffff
XOR EAX,EAX
ADD ESP,0xc
SCASB.REPNE ES:EDI
NOT ECX
DEC ECX
MOV dword ptr [0x00e364f0],ESI
NEG ECX
SBB ECX,ECX
NEG ECX
DEC ECX
MOV dword ptr [0x004b6c90],ECX
CALL 0x00421d80
TEST EAX,EAX
JZ 0x00421c7d
PUSH ESI
PUSH ESI
CALL 0x0044e530
ADD ESP,0x8
PUSH ESI
CALL 0x00421b20
ADD ESP,0x4
XOR EAX,EAX
POP EDI
TEST ESI,ESI
SETZ AL
POP ESI
ADD ESP,0x104
RET
